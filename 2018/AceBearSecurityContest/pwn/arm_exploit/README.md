# arm-exploit
**Category:** Pwnable
**Points:** 856
**Solves:** 13
**Description:**
> Download in : [Link](https://drive.google.com/open?id=1aM2CTWFxKetOTMNfck71Bxv_ZGw05IzF)
> Service: nc armexploit.acebear.site 3001

## Writeup
```
$ file arm-exploit
arm-exploit: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.3, for GNU/Linux 3.2.0, BuildID[sha1]=cbaf26f5088911adc7a36ef8ac96660a33f617d1, not stripped
```

### Setup Environment
#### Install
```
sudo apt-get install qemu
sudo apt-get install qemu-user-static kpartx
sudo apt-get install gdb-multiarch
```

#### Run
```
$ qemu-arm-static ./arm-exploit 
**************************Welcome to Arm Exploit**************************
*                                                                        *
*************************Challenge Created By CNV*************************
*   Team: AceBear                                                        *
*   My blog: https://chung96vn.blogspot.com/                             *
**************************************************************************
*******************Arm Exploit******************
*                                              *
* 1 - info                                     *
* 2 - login                                    *
* 3 - echo                                     *
* 4 - change username                          *
* 5 - exit                                     *
************************************************
Your choice:
```

#### Debug over gdb-multiarch
Terminal 1
> qemu-arm-static -g 12345 ./arm-exploit

Terminal 2
```
$ gdb-multiarch
pwndbg> set architecture arm
The target architecture is assumed to be arm
pwndbg> target remote localhost:12345
Remote debugging using localhost:12345
0xf67d6a40 in ?? ()
...
 â–º f 0 f67d6a40
pwndbg>
```

#### Run over python script
```python
import pwntools
r = process(["qemu-arm-static","-g","12345", "./arm-exploit"]) # run and debug
r = process(["qemu-arm-static","./arm-exploit"]) # Just run
```

### The Bug
Binary has some functions: genpass, info, login, echo, change username and exit.

First bug in **change_username** function:
* user input max 0x20 bytes into buf in stack
* strcpy(USER, buf) if 0x20 bytes buf not null then 0x20 bytes copy into USER and last null bytes will copy to USER+0x20 ==  isGuestLogin => isGuestLogin = 0 => bypass root login then we can use rootecho function.

Second bug in **rootecho** function:
* buff in FP-0x88 but read 0x100 bytes => stack overflow.

### exploit
[arm_exploit.py](/arm_exploit.py)

